!-----------------------------------------------------------------------------------------
! Tao

&tao_start
  n_universes = 1
  plot_file    = '$EIC_LATTICE/bmad/tao/tao_plot.init '
  startup_file = '$EIC_LATTICE/bmad/tao/tao.startup'
/


!--------------------------------------------------------
&tao_design_lattice
!  unique_name_suffix="*::_##?"
    design_lattice(1)%file='cooler.lat.bmad'
 !   design_lattice(2)%file='hadron_ir2.lat'
/


&tao_params
  !global%plot_on = T
  global%track_type = 'single'
  global%beam_timer_on = T
  global%random_engine = 'pseudo' ! or: 'quasi'
  global%de_lm_step_ratio = 1500
  global%optimizer = 'lmdif'
  global%n_opti_cycles = 100
  !---Bmad---
  bmad_com%radiation_damping_on = F
  bmad_com%radiation_fluctuations_on = T
/




!-----------------------------------------------------------------------------------------
! Beam


&tao_beam_init
  beam_init%n_particle = 100000
  beam_init%random_engine = 'quasi'
  ix_universe = 1
  beam_saved_at =  "MARKER::*"
  !track_start = 'MG.Mar.BEG'
  !beam_init%position_file = '$EIC_LATTICE/bmad/beams/beam.h5'  
  !beam_dump_file = 'beam_dump.h5'
  !beam_dump_at = 'm_*'
  beam_init%a_norm_emit = 2.5e-6
  beam_init%b_norm_emit = 2.5e-6
  beam_init%dPz_dz = 0.0
  beam_init%n_bunch = 1     
  beam_init%bunch_charge = 1e-9
  beam_init%sig_pz = 2.5e-4
  beam_init%sig_z = 0.005
/




!-----------------------------------------------------------------------------------------
! Data


!--------- beam ----------
&tao_d2_data
        d2_data%name = 'end'
        n_d1_data = 1
/
&tao_d1_data
    ix_d1_data = 1
    d1_data%name = 'twiss'
    datum( 1) =  'beta.a'     '' '' 'END'   'target'  13.2   1e1
    datum( 2) =  'alpha.a'    '' '' 'END'   'target'   1.67  1e2
    datum( 3) =  'beta.b'     '' '' 'END'   'target'  13.2   1e1
    datum( 4) =  'alpha.b'    '' '' 'END'   'target'   1.67  1e2    
    
/  





!-----------------------------------------------------------------------------------------
! Variables

&tao_var
    v1_var%name = 'begtwiss'
    default_step = 1e-4
    default_universe = '1'
    ix_min_var = 1
    ix_max_var = 6
    var(1:6)%ele_name  = 'beginning', 'beginning', 'beginning', 'beginning', 'beginning', 'beginning'
    var(1:6)%attribute = 'beta_a', 'alpha_a', 'beta_b', 'alpha_b', 'eta_x', 'etap_x'
    var(1)%low_lim = 0.01
    var(3)%low_lim = 0.01
/

&tao_var
    v1_var%name = 'begfloor'
    default_step = 1e-4
    default_universe = '1'
    ix_min_var = 1
    ix_max_var = 3
    var(1:3)%ele_name  = 'beginning', 'beginning', 'beginning'
    var(1:3)%attribute = 'x_position', 'z_position', 'theta_position'

/
